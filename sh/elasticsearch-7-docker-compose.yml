# docker-compose -f elasticsearch-7-docker-compose.yml up -d
version: '3.1'
services:
  cerebro:
    image: lmenezes/cerebro:0.8.5
    container_name: 'cerebro'
    ports:
      - 19201:9000
    command:
      - -Dhosts.0.host=http://elasticsearch:9200
    networks:
      - elk7
  kibana:
    image: docker.elastic.co/kibana/kibana:7.5.1
    container_name: 'kibana7'
    environment:
      - I18N_LOCALE=zh-CN
      - XPACK_GRAPH_ENABLED=true
      - TIMELION_ENABLED=true
      - XPACK_MONITORING_COLLECTION_ENABLED=true
    ports:
      - 15601:5601
    networks:
      - elk7
  elasticsearch:
    image: elasticsearch:7.5.1
    container_name: 'elasticsearch7_01'
    environment:
      - cluster.name=geektime
      - node.name=elasticsearch7_01
      - bootstrap.memory_lock=true
      - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
      - discovery.seed_hosts=elasticsearch7_01
      - cluster.initial_master_nodes=elasticsearch7_01,elasticsearch7_02
    ulimits:
      memlock:
        soft: -1
        hard: -1
    volumes:
      - es7data1:/usr/share/elasticsearch/data
    ports:
      - 19210:9200
    networks:
      - elk7
  elasticsearch2:
    image: elasticsearch:7.5.1
    container_name: 'elasticsearch7_02'
    environment:
      - cluster.name=geektime
      - node.name=elasticsearch7_02
      - bootstrap.memory_lock=true
      - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
      - discovery.seed_hosts=elasticsearch7_01
      - cluster.initial_master_nodes=elasticsearch7_01,elasticsearch7_02
    ulimits:
      memlock:
        soft: -1
        hard: -1
    volumes:
      - es7data2:/usr/share/elasticsearch/data
    ports:
      - 19220:9200
    networks:
      - elk7

volumes:
  es7data1:
    driver: local
  es7data2:
    driver: local

networks:
  elk7:
    driver: bridge
